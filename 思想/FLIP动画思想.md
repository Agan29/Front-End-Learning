# FLIP动画思想

`FLIP`是一种助记缩写也是一种 `Paul Lewis`首创的技术， 代表 `First`, `Last`, `Invert`, `Play`。

- `First` 元素的初始状态。 在发生任何事情之前，记录将要过渡的元素的当前（即，first）位置和尺寸。 可以使用`element.getBoundingClientRect()` 来获取。
- `Last` 元素的最后（即 last）位置和尺寸。
- `Invert` 由于元素处于最后位置，所以我们希望通过使用`transform`修改其位置和尺寸来创建它处于第一位置的错觉.
- `Play` 执行动画，通过将其 `transform` 设置为 `none`，将其移回到最后位置。

**这种动画方法，适合以下场景：**

动画的`Fist`(初始态)或`Last`(最终态)不明确，这时候，使用FLIP非常容易做出动画效果。
而状态都明确的条件下，使用FLIP是多此一举。

## FLIP能提高动画流畅度

用户在网页上进行交互时，比如`click`，`touch`，从交互结束到感知到程序的相应大约需要100ms的生理反应时间。如果你的网站在100ms内作出了相应的响应，那么在用户看来，就是得到了立即的响应。否则用户就会觉得反应延迟。
所以我们在用户交互后要做100ms内准备好动画，然后以60fps的帧速进行动画的运行。这些动画准备计算就是`getBoundingClientRect`(或`getComputedStyle`)等的计算，而60fps的帧率，则需要通过`transform`或者`opacity`的反转动画来实现。我们先将元素设置到了结束位置，通过`transform`来模拟开始位置，然后去除`transform`这个反向的过程，使得浏览器知道了动画的开始位置和结束位置，计算量锐减，流畅度速度提升。

只要FLIP动画反转时间不超过100ms，就是一个流畅的动画，多数情况下，是不会超过的，甚至比正向动画还要快速。

![](https://gitee.com/zukunft/MDImage/raw/master/img/20201122004049.png)

## 一些注意事项

- 不要超出用户反应时间 100ms。否则用户会觉得你的应用没有立即响应，通过 DevTools 时刻留意是哪些计算导致超出了这个时间。
- 精心组织你的动画。设想一下，如果一个 FLIP 动画正在运行，同时你接着想执行下一个 FLIP 动画，这时就要确保下一个动画的预计算工作是在闲置或用户的反应时间内进行，这样就可以保证两个动画互不影响。
- 内容可能被扭曲。当进行某些缩放动画时可能导致内容扭曲。

 FLIP动画，是一种动画机制，策略，通过反转动画来提高流畅度，只能说是一种hack技术。